  # üöö VTEX Freight Calculator

  ![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
  ![PySide6](https://img.shields.io/badge/PySide6-6.0+-green.svg)
  ![VTEX](https://img.shields.io/badge/VTEX-API-orange.svg)
  ![License](https://img.shields.io/badge/License-MIT-yellow.svg)
  ![Platform](https://img.shields.io/badge/Platform-Windows-lightgrey.svg)

  > **Simulador de Frete VTEX** - Aplica√ß√£o desktop para simular custos de frete e consultar estoque em m√∫ltiplas lojas VTEX simultaneamente com interface moderna e processamento paralelo.

  ## üìã √çndice

  - [üéØ Sobre o Projeto](#-sobre-o-projeto)
  - [‚ú® Funcionalidades](#-funcionalidades)
  - [üñ•Ô∏è Interface](#Ô∏è-interface)
  - [üì¶ Instala√ß√£o](#-instala√ß√£o)
  - [üöÄ Como Usar](#-como-usar)
  - [‚öôÔ∏è Configura√ß√£o](#Ô∏è-configura√ß√£o)
  - [üîß Gerando o Execut√°vel](#-gerando-o-execut√°vel)
  - [üìã Requisitos](#-requisitos)
  - [üèóÔ∏è Arquitetura](#Ô∏è-arquitetura)
  - [ü§ù Contribui√ß√£o](#-contribui√ß√£o)
  - [üìÑ Licen√ßa](#-licen√ßa)

  ## üéØ Sobre o Projeto

  O **VTEX Freight Calculator** √© uma aplica√ß√£o desktop desenvolvida em Python com PySide6 que permite simular custos de frete e consultar estoque em m√∫ltiplas lojas VTEX simultaneamente. A aplica√ß√£o utiliza processamento paralelo com threads para otimizar as consultas √† API VTEX e oferece uma interface moderna e intuitiva para an√°lise de dados de log√≠stica.

  ### üé® Caracter√≠sticas T√©cnicas
  - **Interface Moderna**: PySide6 com design responsivo e cores personaliz√°veis
  - **Processamento Paralelo**: Threads ass√≠ncronas para consultas simult√¢neas √† API
  - **Sistema de Configura√ß√£o**: Gerenciamento persistente de configura√ß√µes por empresa
  - **Tela de Splash**: Anima√ß√£o de carregamento com progresso
  - **Execut√°vel Autocontido**: Build modular com PyInstaller

  ## ‚ú® Funcionalidades

  ### üèÜ **Ranking de Lojas**
  - Exibe ranking das melhores lojas baseado em custo e prazo
  - Filtros por tipo de entrega (normal, retirada)
  - Ordena√ß√£o autom√°tica por melhor custo-benef√≠cio
  - Destaque visual para top 3 posi√ß√µes
  - Informa√ß√µes de estoque e transportadoras

  ### üìä **An√°lise Detalhada**
  - Vis√£o detalhada de cada loja selecionada
  - Compara√ß√£o de op√ß√µes de frete (entregas normais e retirada)
  - C√°lculo de prazos de entrega com datas estimadas
  - Formata√ß√£o de valores em moeda brasileira
  - Informa√ß√µes de transportadoras e modalidades

  ### üìç **Pontos de Retirada**
  - Lista de pontos de retirada dispon√≠veis por loja
  - Endere√ßos formatados e organizados
  - Informa√ß√µes de dist√¢ncia e disponibilidade
  - Tabela organizada com pre√ßos e prazos

  ### ‚ùå **Lojas Sem Entrega**
  - Identifica√ß√£o de lojas sem op√ß√µes de entrega
  - Informa√ß√µes de estoque dispon√≠vel
  - Filtro por lojas nacionais
  - Diferencia√ß√£o entre estoque zerado e fora do range de CEP

  ### üì¶ **Consulta de Estoque**
  - Consulta simult√¢nea em m√∫ltiplas lojas
  - Visualiza√ß√£o de estoque total e principal (1_1)
  - Interface dedicada para an√°lise de invent√°rio
  - Destaque visual para estoque baixo/zerado

  ### üìÑ **Exporta√ß√£o JSON**
  - Exporta√ß√£o completa dos dados em formato JSON
  - Estrutura organizada para an√°lise posterior
  - Bot√£o para copiar JSON para √°rea de transfer√™ncia
  - Compat√≠vel com ferramentas de an√°lise de dados

  ### ‚öôÔ∏è **Sistema de Configura√ß√£o**
  - Configura√ß√£o personalizada por empresa
  - Gerenciamento de lojas e filiais com importa√ß√£o/exporta√ß√£o Excel
  - Sistema de cores personaliz√°vel
  - Tokens de autentica√ß√£o VTEX
  - Configura√ß√µes de performance (workers, timeout)

  ## üñ•Ô∏è Interface

  A aplica√ß√£o possui uma interface moderna dividida em:

  - **Painel Esquerdo**: Entrada de dados (CEP, SKU, sele√ß√£o de lojas)
  - **Painel Direito**: Resultados organizados em abas
  - **Barra de Status**: Informa√ß√µes de progresso e status
  - **Sistema de Abas**: Organiza√ß√£o clara das funcionalidades
  - **Tela de Splash**: Anima√ß√£o de carregamento com progresso

  ### Componentes da Interface
  - **InputPanel**: Painel de entrada com valida√ß√£o de CEP e SKU
  - **HeaderWidget**: Cabe√ßalho personalizado com nome da empresa
  - **StatusBarWidget**: Barra de status com mensagens coloridas
  - **SplashScreen**: Tela de carregamento com anima√ß√£o

  ## üì¶ Instala√ß√£o

  ### Pr√©-requisitos
  - Python 3.8 ou superior
  - Windows 10/11
  - Conex√£o com internet
  - Conta VTEX com API habilitada
  - App Key e App Token da VTEX com permiss√µes adequadas

  ### Instala√ß√£o Manual

  1. **Clone o reposit√≥rio:**
  ```bash
  git clone https://github.com/seu-usuario/vtex-freight-calculator.git
  cd vtex-freight-calculator
  ```

  2. **Instale as depend√™ncias:**
  ```bash
  pip install -r requirements.txt
  ```

  3. **Execute a aplica√ß√£o:**
  ```bash
  python main.py
  ```

  ### Instala√ß√£o via Execut√°vel

  1. **Baixe o execut√°vel:**
    - `SimuladorFrete2025_Modular.exe`

  2. **Execute o arquivo:**
    - Duplo clique no execut√°vel
    - A aplica√ß√£o ser√° executada automaticamente
    - As configura√ß√µes s√£o salvas na pasta do usu√°rio: `C:\Users\[Usu√°rio]\VTEX_Freight_Calculator\`


  ## üöÄ Como Usar

  ### 1. **Configura√ß√£o Inicial**
  - Abra a aplica√ß√£o
  - V√° para a aba "‚öôÔ∏è Configura√ß√µes"
  - Clique em "üîß Configurar Empresa"
  - Configure sua empresa e lojas (veja se√ß√£o [‚öôÔ∏è Configura√ß√£o](#Ô∏è-configura√ß√£o) para detalhes)

  ### 2. **Simula√ß√£o de Frete**
  - **Digite o CEP** de destino (formato: 00000-000)
  - **Selecione o SKU** do produto (hist√≥rico autom√°tico)
  - **Escolha as lojas** para simular (filtro dispon√≠vel)
  - **Clique em "‚ñ∂ SIMULAR FRETE"**

  ### 3. **An√°lise dos Resultados**
  - **üèÜ Ranking**: Melhores op√ß√µes de frete ordenadas
  - **üìä Detalhada**: An√°lise por loja com seletor
  - **üìç Retirada**: Pontos de retirada organizados
  - **‚ùå Sem Entrega**: Lojas sem op√ß√µes com filtro
  - **üì¶ Estoque**: Consulta de invent√°rio
  - **üìÑ JSON**: Dados completos para exporta√ß√£o

  ### 4. **Consulta de Estoque**
  - V√° para a aba "üì¶ Estoque"
  - Digite o SKU do produto
  - Clique em "CONSULTAR ESTOQUE"
  - Visualize o estoque por loja com destaque visual

  ## ‚öôÔ∏è Configura√ß√£o

  ### Configura√ß√£o da Empresa

  #### **Informa√ß√µes da Empresa**
  - **Nome da empresa**: Nome que aparecer√° no cabe√ßalho da aplica√ß√£o
  - **App Key**: Chave de aplica√ß√£o da VTEX (obtida no Admin da VTEX)
  - **App Token**: Token de autentica√ß√£o da VTEX (obtido no Admin da VTEX)

  > ‚ö†Ô∏è **PERMISS√ïES NECESS√ÅRIAS**: O App Token deve ter acesso a:
  > - **Conta Principal**: Para consultas gerais e medi√ß√£o de SLAs
  > - **Todas as Lojas**: Para consultar estoque e simular frete
  > - **APIs de Log√≠stica**: Para simula√ß√£o de frete e consulta de estoque

  #### **Lojas e Filiais**
  - **Adicionar/remover lojas**: Gerenciar lista de lojas
  - **ID da Loja**: Deve ser exatamente igual ao ID no Gerenciador de Marketplace da VTEX
  - **Tipo de Entrega**: Nacional (todo Brasil) ou Local (regional)
  - **Propriedade**: Franquia ou Pr√≥pria
  - **Conta Principal**: ‚≠ê **CR√çTICO** - Apenas uma loja pode ser principal
  - **Importar/exportar Excel**: Gerenciar lojas em massa

  #### **Configura√ß√µes de Performance**
  - **N√∫mero m√°ximo de workers**: Threads paralelas (padr√£o: 20)
  - **Timeout de requisi√ß√µes**: Tempo limite por requisi√ß√£o (padr√£o: 10s)
  - **SKU padr√£o**: SKU inicial para simula√ß√£o
  - **Hist√≥rico de SKUs recentes**: Quantos SKUs lembrar (padr√£o: 5)

  > üîß **CONFIGURA√á√ïES OTIMIZADAS**: As configura√ß√µes padr√£o s√£o otimizadas para performance e estabilidade. N√£o √© necess√°rio alterar a menos que tenha necessidades espec√≠ficas.

  ### Fluxo de Configura√ß√£o

  #### **1. Configura√ß√£o Inicial**
  1. Abra a aplica√ß√£o
  2. V√° para a aba "‚öôÔ∏è Configura√ß√µes"
  3. Clique em "üîß Configurar Empresa"
  4. Preencha as informa√ß√µes da empresa
  5. Configure as lojas
  6. Salve as configura√ß√µes
  7. Feche e reabra a aplica√ß√£o para aplicar as mudan√ßas

  #### **2. Configura√ß√£o de Lojas**
  1. **Adicionar Loja**: Clique em "Adicionar Loja"
  2. **ID da Loja**: Use exatamente o mesmo ID do Gerenciador de Marketplace da VTEX
  3. **Nome**: Nome descritivo para identifica√ß√£o
  4. **Tipo**: Nacional (todo Brasil) ou Local (regional)
  5. **Propriedade**: Franquia ou Pr√≥pria
  6. **Conta Principal**: ‚≠ê Marque apenas UMA loja como principal

  #### **3. Importa√ß√£o em Massa**
  - Use "üìä Exportar Excel" para criar template
  - Preencha o Excel com suas lojas
  - Use "üì• Importar Excel" para importar todas as lojas

  ### üéØ Import√¢ncia da Loja Principal

  A **loja principal** √© fundamental para o funcionamento da aplica√ß√£o:

  #### **Fun√ß√µes da Loja Principal**
  - **Centro de Distribui√ß√£o**: Serve como refer√™ncia para medi√ß√£o de SLAs
  - **Medi√ß√£o de Performance**: Compara performance das outras lojas
  - **Configura√ß√£o Autom√°tica**: A aplica√ß√£o identifica automaticamente qual √© a principal
  - **Apenas Uma**: S√≥ pode haver uma loja marcada como principal

  #### **Como Configurar**
  1. **Adicione todas as lojas** primeiro
  2. **Marque apenas UMA** como "Conta Principal"
  3. **Salve as configura√ß√µes**
  4. **Reinicie a aplica√ß√£o** para aplicar as mudan√ßas

  > ‚ö†Ô∏è **ATEN√á√ÉO**: Se n√£o configurar uma loja principal, a aplica√ß√£o n√£o conseguir√° medir os SLAs das outras lojas corretamente.

  ### Estrutura de Configura√ß√£o

  ```json
  {
    "empresa": {
      "nome": "Sua Empresa",
      "conta_principal": "sua-empresa",
      "app_key": "sua-app-key",
      "app_token": "seu-app-token"
    },
    "lojas": [
      {
        "id": "loja-id",
        "nome": "Nome da Loja",
        "tipo": "Nacional",
        "nacional": true,
        "propriedade": "Pr√≥pria",
        "conta_principal": false
      }
    ],
    "configuracoes": {
      "sku_padrao": "149718",
      "max_skus_recentes": 5,
      "max_workers": 20,
      "timeout_requests": 10
    },
    "cores": {
      "primaria": "#E91E63",
      "secundaria": "#FFFFFF",
      "destaque": "#E91E63",
      "fundo": "#FFFFFF",
      "texto": "#333333",
      "borda": "#F5F5F5",
      "destaque2": "#C2185B"
    }
  }
  ```

  ## üîß Gerando o Execut√°vel

  ### M√©todo Autom√°tico (Recomendado)

  1. **Execute o script de build:**
  ```bash
  python build_encrypted.py
  ```

  2. **O script ir√°:**
    - Verificar depend√™ncias automaticamente
    - Instalar PyInstaller se necess√°rio
    - Criar o execut√°vel modular autocontido
    - Limpar arquivos tempor√°rios
    - Gerar `SimuladorFrete2025_Modular.exe`

  ### M√©todo Manual

  1. **Instale o PyInstaller:**
  ```bash
  pip install pyinstaller
  ```

  2. **Execute o comando:**
  ```bash
  pyinstaller --onefile --windowed --name=SimuladorFrete2025 --icon=entrega-rapida.ico main.py
  ```

  ### Caracter√≠sticas do Execut√°vel

  - **Modular**: Todos os m√≥dulos integrados
  - **Autocontido**: N√£o precisa de instala√ß√£o Python
  - **Port√°vel**: Pode ser copiado para qualquer lugar
  - **Configur√°vel**: Sistema de configura√ß√£o integrado
  - **Persistente**: Configura√ß√µes salvas na pasta do usu√°rio
  - **Seguro**: Configura√ß√µes isoladas por usu√°rio

  ### Localiza√ß√£o das Configura√ß√µes

  - **Execut√°vel**: `C:\Users\[Usu√°rio]\VTEX_Freight_Calculator\empresa_config.json`
  - **Script Python**: `empresa_config.json` (na pasta do projeto)
  - **Backup**: Configura√ß√µes s√£o salvas automaticamente
  - **Portabilidade**: Cada usu√°rio tem suas pr√≥prias configura√ß√µes

  ## üìã Requisitos

  ### Sistema
  - **OS**: Windows 10/11
  - **RAM**: 4GB m√≠nimo, 8GB recomendado
  - **Espa√ßo**: 100MB para instala√ß√£o
  - **Internet**: Conex√£o est√°vel

  ### Depend√™ncias Python
  ```
  PySide6>=6.0.0
  requests>=2.25.0
  pyinstaller>=4.0
  openpyxl>=3.0.0
  ```

  ### API VTEX
  - Conta VTEX ativa
  - App Key e App Token v√°lidos
  - Permiss√µes de API habilitadas

  ## üèóÔ∏è Arquitetura

  ### Estrutura do Projeto

  ```
  simulador-de-frete/
  ‚îú‚îÄ‚îÄ main.py                 # Classe principal FreteSimulator
  ‚îú‚îÄ‚îÄ config_manager.py       # Gerenciador de configura√ß√µes persistente
  ‚îú‚îÄ‚îÄ config_ui.py           # Interface de configura√ß√£o com Excel
  ‚îú‚îÄ‚îÄ ui_components.py       # Componentes de UI (InputPanel, Header, Status)
  ‚îú‚îÄ‚îÄ utils.py               # Fun√ß√µes utilit√°rias (valida√ß√£o, formata√ß√£o)
  ‚îú‚îÄ‚îÄ threads.py             # Threads de processamento paralelo
  ‚îú‚îÄ‚îÄ splash_screen.py       # Tela de splash com anima√ß√£o
  ‚îú‚îÄ‚îÄ build_encrypted.py     # Script de build modular
  ‚îú‚îÄ‚îÄ tabs/                  # M√≥dulos de abas
  ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
  ‚îÇ   ‚îú‚îÄ‚îÄ ranking_tab.py     # Aba de ranking com tabela
  ‚îÇ   ‚îú‚îÄ‚îÄ resumo_tab.py      # Aba de resumo detalhado
  ‚îÇ   ‚îú‚îÄ‚îÄ retirada_tab.py    # Aba de pontos de retirada
  ‚îÇ   ‚îú‚îÄ‚îÄ estoque_tab.py     # Aba de consulta de estoque
  ‚îÇ   ‚îú‚îÄ‚îÄ sem_entrega_tab.py # Aba de lojas sem entrega
  ‚îÇ   ‚îî‚îÄ‚îÄ json_tab.py        # Aba de exporta√ß√£o JSON
  ‚îú‚îÄ‚îÄ entrega-rapida.ico     # √çcone da aplica√ß√£o
  ‚îú‚îÄ‚îÄ VTEX_Logo.svg.png      # Logo VTEX
  ‚îî‚îÄ‚îÄ README.md
  ```

  ### Componentes Principais

  - **FreteSimulator**: Classe principal da aplica√ß√£o
  - **ConfigManager**: Gerenciamento de configura√ß√µes com persist√™ncia
  - **InputPanel**: Painel de entrada de dados com valida√ß√£o
  - **StatusBarWidget**: Barra de status com mensagens coloridas
  - **SimulacaoThread**: Thread para processamento paralelo de simula√ß√£o
  - **EstoqueThread**: Thread para consulta paralela de estoque

  ### Fluxo de Dados

  1. **Entrada**: CEP, SKU, lojas selecionadas
  2. **Valida√ß√£o**: Valida√ß√£o de CEP e SKU
  3. **Processamento**: Threads ass√≠ncronas para API VTEX
  4. **An√°lise**: C√°lculo de custos, prazos e estoque
  5. **Exibi√ß√£o**: Resultados organizados em abas
  6. **Persist√™ncia**: Configura√ß√µes salvas automaticamente

  ### APIs Utilizadas

  - **Simula√ß√£o de Frete**: `/api/checkout/pub/orderForms/simulation`
  - **Pol√≠ticas de Envio**: `/api/logistics/pvt/shipping-policies`
  - **Consulta de Estoque**: `/api/logistics/pvt/inventory/skus/{sku}`

